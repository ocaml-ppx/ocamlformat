92d91
< let ghrhs rhs loc = mkloc rhs (ghost_loc loc)
181,205d179
< let ghexp_cons_desc consloc args =
<   Pexp_construct(ghrhs (Lident "::") consloc, Some args)
< let ghpat_cons_desc consloc args =
<   Ppat_construct(ghrhs (Lident "::") consloc, Some ([], args))
< 
< let rec mktailexp nilloc = let open Location in function
<     [] ->
<       let nil = ghloc ~loc:nilloc (Lident "[]") in
<       Pexp_construct (nil, None), nilloc
<   | e1 :: el ->
<       let exp_el, el_loc = mktailexp nilloc el in
<       let loc = (e1.pexp_loc.loc_start, snd el_loc) in
<       let arg = ghexp ~loc (Pexp_tuple [e1; ghexp ~loc:el_loc exp_el]) in
<       ghexp_cons_desc loc arg, loc
< 
< let rec mktailpat nilloc = let open Location in function
<     [] ->
<       let nil = ghloc ~loc:nilloc (Lident "[]") in
<       Ppat_construct (nil, None), nilloc
<   | p1 :: pl ->
<       let pat_pl, el_loc = mktailpat nilloc pl in
<       let loc = (p1.ppat_loc.loc_start, snd el_loc) in
<       let arg = ghpat ~loc (Ppat_tuple [p1; ghpat ~loc:el_loc pat_pl]) in
<       ghpat_cons_desc loc arg, loc
< 
2445c2419
<       { fst (mktailexp $loc($3) $2) }
---
>       { Pexp_list $2 }
2449,2452c2423
<       { let list_exp =
<           (* TODO: review the location of list_exp *)
<           let tail_exp, _tail_loc = mktailexp $loc($5) $4 in
<           mkexp ~loc:($startpos($3), $endpos) tail_exp in
---
>       { let list_exp = mkexp ~loc:($startpos($3), $endpos) (Pexp_list $4) in
2821c2792
<       { fst (mktailpat $loc($3) $2) }
---
>       { Ppat_list $2 }
